#!/usr/bin/env bash

waybar_path="${XDG_CONFIG_HOME:-$HOME/.config}/waybar"
new_preset="${waybar_path}/type/${1}.jsonc"
new_style="${waybar_path}/styles/${1}.css"

err() {
  echo -e "$1" >&2
}

if [[ $# -ne 1 ]]; then
  err "Error: Invalid number of arguments. (1 required, $# provided)"
  exit 1
fi

if [[ ! -f "$new_style" ]]; then
  err "Error: Style ${new_style} is not found."
  exit 1
fi

if [[ ! -f "$new_preset" ]]; then
  err "Error: Preset ${new_preset} is not found."
  exit 1
fi

ln -sf "${new_preset}" "${waybar_path}"/config.jsonc
ln -sf "${new_style}" "${waybar_path}"/main-preset.css

# Restarts waybar
systemctl --user restart waybar && notify-send -e -t 3000 "Waybar reloaded..." "Current preset: $1"
