#!/usr/bin/env bash

src_dir="${XDG_CONFIG_HOME:-$HOME/.config}/waybar/type"

mapfile -t files < <(
  find "$src_dir" -maxdepth 1 -type f -name "*.jsonc" -print0 | xargs -0 -I{} basename "{}" .jsonc
)

if [ -n "$(pgrep rofi)" ]; then
  pkill rofi
  exit
fi

selected_presets=$(printf "%s\n" "${files[@]}" | rofi -dmenu -theme-str 'entry {placeholder: "Select desktop presets...";}')

if [ -n "$selected_presets" ]; then
  preset-change "$selected_presets"
fi
